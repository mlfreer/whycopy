{{ block title }}
<div style="float: center; text-align: center;">
    Please choose an option (Decison <b style ="color:#0d6efd">{{player.subsession.round_number}}</b> out of <b>{{C.NUM_ROUNDS}}</b>)
</div>
{{ endblock }}

{{ block content }}

<font size="4">
    <table class="table">
        <tr>
            <td> </td>
            <td> <b> Payment if Heads </b> </td>
            <td> <b> Payment if Tails </b> </td>
            <td> </td>
            <td> </td>
        </tr>

        <tr>
            <td> <b> Option 1 </b>
            </td>
            <td>
                <b> {{ lottery_1.0 }} </b>
            </td>
            <td>
                <b> {{ lottery_1.1 }} </b>
            </td>
            <td> 
                <input type="range" oninput = "update_value(option1_slider,option1_form)" min="0" max="100" step="1" class="slider" id="option1" value="0" name="complex_shares_1">
            </td>
            <td>
                <div class="input-group">
                <input type="button" onclick="dec(option1_form,option1_slider)" class="btn btn-outline-secondary" id="option1_form_dec" value="-">
                <input type="number" oninput = "update_value(option1_form,option1_slider)" class="form-control" id="option1_form" name="complex_shares_1" min="0" max="100" step="1" value="0"/>
                <input type="button" onclick="inc(option1_form,option1_slider)" class="btn btn-outline-secondary" id="option1_form_inc" value="+">
            </div>
            </td>
        </tr>
        <tr>
            <td> <b> Option 2 </b>
            </td>
            <td>
                <b> {{ lottery_2.0 }} </b>
            </td>
            <td>
                <b> {{ lottery_2.1 }} </b>
            </td>
            <td>
                <input type="range" oninput = "update_value(option2_slider,option2_form)" min="0" max="100" step="1" id="option2" value="0" name="complex_shares_2">
            </td>
            <td>
                <div class="input-group">
                <input type="button" onclick="dec(option2_form,option2_slider)"  class="btn btn-outline-secondary" id="option2_form_dec" value="-">
                <input type="number" oninput = "update_value(option2_form,option2_slider)" class="form-control" id="option2_form" name="complex_shares_2" min="0" max="100" step="1" value="0"/>
                <input type="button" onclick="inc(option2_form,option2_slider)" class="btn btn-outline-secondary" id="option2_form_inc" value="+">
            </div>
            </td>
        </tr>

        <tr>
            <td> <b> Option 3 </b>
            </td>
            <td>
                <b> {{ lottery_3.0 }} </b>
            </td>
            <td>
                <b> {{ lottery_3.1 }} </b>
            </td>
            <td>
                <input type="range" oninput = "update_value(option3_slider,option3_form)" min="0" max="100" step="1" id="option3" value="0" name="complex_shares_3">
            </td>
            <td>
                <div class="input-group">
                <input type="button" onclick="dec(option3_form,option3_slider)"  class="btn btn-outline-secondary" id="option3_form_dec" value="-">
                <input type="number" oninput = "update_value(option3_form,option3_slider)" class="form-control" id="option3_form" name="complex_shares_3" min="0" max="100" step="1" value="0"/>
                <input type="button" onclick="inc(option3_form,option3_slider)" class="btn btn-outline-secondary" id="option3_form_inc" value="+">
            </div>
            </td>
        </tr>

        <tr>
            <td> <b> Option 4 </b>
            </td>
            <td>
                <b> {{ lottery_4.0 }} </b>
            </td>
            <td>
                <b> {{ lottery_4.1 }} </b>
            </td>
            <td>
                <input type="range" oninput = "update_value(option4_slider,option4_form)" min="0" max="100" step="1" id="option4" value="0" name="complex_shares_4">
            </td>
            <td>
                <div class="input-group">
                <input type="button" onclick="dec(option4_form,option4_slider)"  class="btn btn-outline-secondary" id="option4_form_dec" value="-">
                <input type="number" oninput = "update_value(option4_form,option4_slider)" class="form-control" id="option4_form" name="complex_shares_4" min="0" max="100" step="1" value="0"/>
                <input type="button" onclick="inc(option4_form,option4_slider)" class="btn btn-outline-secondary" id="option4_form_inc" value="+">
            </div>
            </td>
        </tr>


        <tr>
            <td> <b> Option 5 </b>
            </td>
            <td>
                <b> {{ lottery_5.0 }} </b>
            </td>
            <td>
                <b> {{ lottery_5.1 }} </b>
            </td>
            <td>
                <input type="range" oninput = "update_value(option5_slider,option5_form)" min="0" max="100" step="1" id="option5" value="0" name="complex_shares_5">
            </td>
            <td>
                <div class="input-group">
                <input type="button" onclick="dec(option5_form,option5_slider)"  class="btn btn-outline-secondary" id="option5_form_dec" value="-">
                <input type="number" oninput = "update_value(option5_form,option5_slider)" class="form-control" id="option5_form" name="complex_shares_5" min="0" max="100" step="1" value="0"/>
                <input type="button" onclick="inc(option5_form,option5_slider)" class="btn btn-outline-secondary" id="option5_form_inc" value="+">
            </div>
            </td>
        </tr>

        <tr>
            <td> <b> Option 6 </b>
            </td>
            <td>
                <b> {{ lottery_6.0 }} </b>
            </td>
            <td>
                <b> {{ lottery_6.1 }} </b>
            </td>
            <td>
                <input type="range" oninput = "update_value(option6_slider,option6_form)" min="0" max="100" step="1" id="option6" value="0" name="complex_shares_6">
            </td>
            <td>
                <div class="input-group">
                <input type="button" onclick="dec(option6_form,option6_slider)"  class="btn btn-outline-secondary" id="option6_form_dec" value="-">
                <input type="number" oninput = "update_value(option6_form,option6_slider)" class="form-control" id="option6_form" name="complex_shares_6" min="0" max="100" step="1" value="0"/>
                <input type="button" onclick="inc(option6_form,option6_slider)" class="btn btn-outline-secondary" id="option6_form_inc" value="+">
            </div>
            </td>
        </tr>


        <tr>
            <td> <b>Leftover Units</b> </td>
            <td> </td>
            <td> </td>
            <td> <input type="range" oninput = "update_value(tokens_slider,tokens_form)" min="0" max="100" step="1" value="100" id="tokens_slider" name="tokens"> </td>
            <td>
                <div class="input-group">
                <input type="button" onclick="dec5(tokens_form,tokens_slider)"  class="btn btn-outline-secondary" id="tokens_dec" value="-">
                <input type="number" oninput = "update_value(tokens_form,tokens_slider)" class="form-control" id="tokens_form" name="tokens" min="0" max="100" step="1" value ="100"/>
                <input type="button" onclick="inc5(tokens_form,tokens_slider)" class="btn btn-outline-secondary" id="tokens_inc" value="+">
            </div>
        </tr>

        <tr>
            <td> </td>
            <td> </td>
            <td> </td>
            <td> <input type="button" onclick="reset_values()" class="btn btn-primary" value="Reset">  </td>
            <td> <input type="button" onclick="validate()" class="btn btn-primary" value="Submit"> </td>
        </tr>
    </table>


<div id="NextButton" style="float: right; visibility:hidden">
{% next_button %}
</div>

</font>



{% load staticfiles %}

<script type="text/javascript" src="{{static 'global/budget_jars.js' }}">
</script>

<script>
function round6(x)
{
    return Math.ceil(x/6)*6;
}


// fixing option 6:
var option6_slider = document.getElementById("option6");
var option6_form = document.getElementById("option6_form");
option6_form.value = option6_slider.value;


// updating value from x to y:
function update_value(x,y) {
    next_button.style.visibility = "hidden";


    a = parseInt(tokens_form.value)
    b = parseInt(x.value)
    c = parseInt(y.value)

    if ((a<0)||(b<0)) {
        reset_values();
        window.alert('Negative values are prohibited. The values are reset.')
        return;
    }


    if ((x.id=="tokens_form") || (x.id=="tokens_slider"))
    {
        temp = round6(b-c);
        x.value = parseInt(y.value) + temp
        b = parseInt(x.value)
        
        diff = temp/6

        option1 = parseInt(option1_form.value)
        option2 = parseInt(option2_form.value)
        option3 = parseInt(option3_form.value)
        option4 = parseInt(option4_form.value)
        option5 = parseInt(option5_form.value)
        option6 = parseInt(option6_form.value)
//        window.alert(option1-diff)
        if ((b<=c) && (option1-diff <=100) && (option2-diff <=100) && (option3-diff <=100) && (option4-diff <=100) && (option5-diff <=100) && (option6-diff <=100))
        {
            
            y.value = x.value
            option1_form.value = option1 - diff;
            option2_form.value = option2 - diff;
            option3_form.value = option3 - diff;
            option4_form.value = option4 - diff;
            option5_form.value = option5 - diff;
            option6_form.value = option6 - diff;

            option1_slider.value = option1 - diff;
            option2_slider.value = option2 - diff;
            option3_slider.value = option3 - diff;
            option4_slider.value = option4 - diff;
            option5_slider.value = option5 - diff;
            option6_slider.value = option6 - diff;
        }
        else
        {
            if ((b>c) && (option1-diff >=0) && (option2-diff  >=0) && (option3-diff  >=0) && (option4-diff  >=0) && (option5-diff  >=0) && (option6-diff >=0))
            {
                y.value = x.value;
                option1_form.value = option1 - diff;
                option2_form.value = option2 - diff;
                option3_form.value = option3 - diff;
                option4_form.value = option4 - diff;
                option5_form.value = option5 - diff;
                option6_form.value = option6 - diff;

                option1_slider.value = option1 - diff;
                option2_slider.value = option2 - diff;
                option3_slider.value = option3 - diff;
                option4_slider.value = option4 - diff;
                option5_slider.value = option5 - diff;
                option6_slider.value = option6 - diff;
            }
            else
            {
                x.value = y.value;

            }
        }
    }
    else
    {
        if (a-b+c >= 0) {
            temp =a-b+c;
//            if ((b-c<=1) && (b-c>=-1)) {window.alert(b-c)}
            tokens_form.value=temp;
//            window.alert(tokens_form.value)
            tokens_slider.value = tokens_form.value
            y.value = x.value
        }
        else
        {   
            
            x.value=y.value
        }
    }

    if ((tokens_form.value>100) || (tokens_slider.valu>100) )    
    {
        reset_values();
    }

}

// to operationlize the buttons
function dec5(form,slider) {
    a = parseInt(form.value)
    if (a >= 6) {       
        form.value = parseInt(form.value)-6
//        window.alert(slider.value)
        update_value(form,slider)
    };
}

function inc5(form,slider) {
    a = parseInt(form.value)
    if (a <= 94) {       
        form.value = parseInt(form.value)+6
        update_value(form,slider)
    };
}


// to operationlize the buttons
function dec(form,slider) {
    a = parseInt(form.value)
    if ((a >= 1) && (a<=100)) {       
        form.value--
//        window.alert(slider.value)
        update_value(form,slider)
    }
}

function inc(form,slider) {
    a = parseInt(form.value)
    if ((a <= 99) && (a>=0)) {  
        form.value++
        update_value(form,slider)
    }
}


// resetting the values
function reset_values() {
    next_button.style.visibility = "hidden";

    option1_form.value = 0
    option2_form.value = 0
    option3_form.value = 0
    option4_form.value = 0
    option5_form.value = 0
    option6_form.value = 0

    option1_slider.value = 0
    option2_slider.value = 0
    option3_slider.value = 0
    option4_slider.value = 0
    option5_slider.value = 0
    option6_slider.value = 0

    tokens_form.value = 100
    tokens_slider.value = 100
}
</script>


<link href="{{ static 'global/budget_jars.css' }}" rel="stylesheet"/>

{{ endblock }}
